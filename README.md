## javascript面试题整理



* **什么是垃圾回收机制**

	JavaScript 垃圾回收的机制很简单：找出不再使用的变量，然后释放掉其占用的内存，但是这个过程不是时时的，因为其开销比较大，所以垃圾回收器会按照固定的时间间隔周期性的执行。

---


* **实现sleep 函数**

	要求用法：
	
	```
	/**
	- 使当前运行的异步操作（promise 或者 async）停止等待若干秒
	- 
	- @param ms */
	(async () => {
	  console.log('hello')
	  await sleep(2000) // 等待两秒
	  console.log('world')
	})()
	```
	
	```
	const sleep = (ms) => {
	  new Promise(resolve, reject) {
	    setTimeOut(() => {
	      resolve();
	    }, ms)
	  }
	}

	```
	
---


* **如何保证缓存与数据库双写时的数据一致性？**

	你只要用缓存，就可能会涉及到缓存与数据库双存储双写，你只要是双写，就一定会有数据一致性的问题，那么你如何解决一致性问题？
	
	一般来说，就是如果你的系统不是严格要求缓存+数据库必须一致性的话，缓存可以稍微的跟数据库偶尔有不一致的情况，最好不要做这个方案，读请求和写请求串行化，串到一个内存队列里去，这样就可以保证一定不会出现不一致的情况
	
	串行化之后，就会导致系统的吞吐量会大幅度的降低，用比正常情况下多几倍的机器去支撑线上的一个请求。

---

* **http的状态码中，499是什么？如何出现499，如何排查跟解决**

	499对应的是 `“client has closed connection”`，客户端请求等待链接已经关闭，这很有可能是因为服务器端处理的时间过长，客户端等得“不耐烦”了。还有一种原因是两次提交post过快就会出现499。
解决方法：

	* 前端将timeout最大等待时间设置大一些
	* nginx上配置`proxy_ignore_client_abort on`;

---
